<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>OpenCVLive - Live image manipulation.</title>
    <!-- From: highlightjs.org -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" />
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- OpenCVLive style and script. -->
    <link rel="stylesheet" type="text/css" href="css/styles.css" />
    <link rel="stylesheet" type="text/css" href="css/site.css" />
    <link rel="stylesheet" type="text/css" href="css/main.css" />
    <link rel="stylesheet" type="text/css" href="css/toolbox.css" />

    <script type="text/javascript" src="js/util.js"></script>
    <script type="text/javascript" src="js/triggers.js"></script>
    <script type="text/javascript" src="js/ui.js"></script>
    <script type="text/javascript" src="js/helpers.js"></script>
    <script type="text/javascript" src="js/dragndrop.js"></script>
    <script type="text/javascript" src="js/keys.js"></script>
    <script type="text/javascript" src="js/scripts.js"></script>
  </head>
  <body>
    <div id="about" data-hide="about" data-hide-default="false">
      What is OpenCV Live?
      <div id="about-closer" data-onclick="toggle" data-target="#about" class="toggle-about">&lt;close&gt;</div>
      <br/>
      <br/>
      <p>
        <span class="quote">
          &quot;Help! I'm a total noob to OpenCV. I don't know how to get the effect
          I want. But hey, I can make a little server to help...&quot; - Me.
        </span>
      </p>
      <p>
      OpenCV can be a bit complicated to use. This little app aims to:
        <ol/>
          <li>
            Let you select one or more images to experiment on. Since this is intended
            to be run locally in your own python environment, I'm not concerned about
            the safety of mine ;).
          </li>
          <li>
            Add a call block. Call blocks act as a tree: top being the
            original image(s). Add and remove call blocks as needed. Blocks
            show thumbnails, click the thumbnail to show the original image.
          </li>
          <li>
            Most blocks have a single input and single output. Some can have
            multiple inputs and/or outputs. That's the main reason this is a
            map instead of a series. Organization is totes up to you.
          </li>
          <li>
            Many blocks will take any type of image matrix and operate on it.
            But some will only work on grayscale. Some on color, etc. If a block
            works on grayscale and you pass it a color image, it will auto-convert
            from color to grayscale. But using default values, which might not
            be what you want. Ditto for grayscale to color, or anything involving
            HSV, BGR. We use BGR here as that seems to be the most common for
            opencv. But if popular demand requests RGB, I'll try adding support
            for multiple types.
          </li>
          <li>
            Create your own python call blocks! This lets you experiment with
           things we can't easily do in a flexible call block. For example:
           Find a pair of arucos and draw a line between them? Find a QR code
           and write its contents on the image? Make your own call blocks!
          </li>
          <li>
            Call blocks you create can easily use the calls.
          </li>
          <li>
            Replace images as necessary. Copy call block trees. Archive and
            reload them.
          </li>
        </ol>
      </p>
      <p>
        We would like to thank highlightjs.org for their fantastic code
        highlighting for our python code examples.
      </p>
    </div>
    <!-- -->
    <div id="upload-dialog" data-upload="/upload" class="dialog" style="display: none;" data-drag="move">
      <form>
      <h3 class="drag-start" >Upload Images</h3>
      <span class="closer" data-onclick="hide">X</span>
      <input type="file" name="image" multiple data-onchange="fileDialogChange">
      <ul id="upload-list"></ul>
      </form>
    </div>
    <div id="head" class="cvstyle">
      <div id="topbar">
        <div id="title" class="toggle-about" data-onclick="toggle" data-target="#about">OpenCVLive&nbsp;<span id="qmark">(About)</span></div>
        <div id="topbar-filler"></div>
      </div>
    </div>
    <div id="sheet">
      <div id="toolbox">
        <h3>
          Library
          <button data-onclick="showUploadDialog">Upload</button>
        </h3>
        <hr/>
        <div class="collection-scroll" data-hover="scrollup" data-target="#library">&uarr;</div>
        <div class="collection" id="library"></div>
        <div class="collection-scroll" data-hover="scrolldown" data-target="#library">&darr;</div>
        <h3>Blocks Available</h3>
        <div class="collection-scroll" data-hover="scrollup" data-target="#block-selection">&uarr;</div>
        <div class="collection" id="block-selection">
        </div>
        <div class="collection-scroll" data-hover="scrolldown" data-target="#block-selection">&darr;</div>
      </div>
      <div id="main">
        <canvas id="flowcanvas" class="layer disabled" disabled>Canvaaaaaaas</canvas>
        <div id="flowchart" class="layer opdrop">
          <div id="trashit" data-drop="removeElement" class="opdrop">&#x1F5D1;</div>
        </div>
      </div>
      <div id="savecol"></div>
    </div>
    <div style="display:none;" id="templates">
      We use get('#templateid').cloneNode().children to fetch the templates.
      Any text before or after it is just comments.
      --

      Image blocks, for when we drag images onto the flowchart.
      <div id="template-imblock">
        <div class="opcontainer" style="width: 8em;" data-drop-ok=".opdrop" data-drag="move" data-drag-bind="#flowchart" data-drag-drop="debugTrigger" data-onmouseover="raiseZIndex" data-zindex="ops">
          <div class="opblock">
            <div class="opinput oparr"><span class="vcenter"></span></div>
            <div class="opcenter">
              <span class="drag-start ophead opdrag"></span>
              <div class="oplower">
                <div class="opiframe" data-onclick="showLargeChildImage" data-drag-click="showLargeChildImage"/>
                  <img class="opimage"/>
                </div>
              </div>
            </div>
            <div class="opoutput oparr"><span class="vcenter">&rarr;</span></div>
          </div>
        </div>
      </div>

      The big kahunas: the blocks in the flowchart that are movable,
      drop-onable, configurable, removable, added, etc.

      They have:
        - A left box for dropping and connecting inputs to.
        - A right box for dragging to others' inputs
        - An operation associated with it
        - An image of the output.
        - Configurable arguments.
      
      <div id="template-opblock">
        <div class="opcontainer" style="width: 14em;" data-drop-ok=".opdrop" data-drag="move" data-drag-bind="#flowchart" data-onmouseover="raiseZIndex" data-zindex="ops" data-drag-drop="debugTrigger">
          <div class="opblock">
            <div class="opinput oparr"><span class="vcenter">&rarr;</span></div>
            <div class="opcenter">
              <span class="drag-start ophead opdrag"></span>
              <div class="oplower">
                <div class="opiframe" data-onclick="showLargeChildImage" data-drag-click="showLargeChildImage"/>
                  <img class="opimage"/>
                </div>
                <div class="opslisting">
                  <div class="ops"></div>
                </div>
              </div>
            </div>
            <div class="opoutput oparr"><span class="vcenter">&rarr;</span></div>
          </div>
        </div>
      </div>

      Library container images.
      <div id="template-library-image">
        <div class="item drag-start" data-drag-click="showLargeChildImage" data-drag="trigger" data-drag-bind="#flowchart" data-drag-drop="addImageAt" data-help="Work with this image">
          <span></span>
          <img/>
        </div>
      </div>

      Effect container images.
      <div id="template-block-effect">
        <div class="item drag-start" data-drag-click="showLargeChildImage" data-drag="trigger" data-drag-bind="#flowchart" data-drag-drop="createEffectAt" data-help="Create an effect">
          <span></span>
          <img/>
        </div>
      </div>

      Basic floating dialog
      <div id="template-floater">
        <div class="dialog drag-me floater" data-drop-ok=".opdrop" data-onmouseover="raiseZIndex" data-zindex="floater" data-drag="reposition" data-drag-bind="body">
          <h3 class="drag-start name"></h3>
          <span class="closer" data-onclick="remove" data-target=".floater">X</span>
          <div class="body"></div>
        </div>
      </div>

      <div id="template-user-alert" class="user-alert dialog" style="display: none;" data-onclick="remove" data-target=".user-alert"></div>

      Large pictures. Not the largest, but those open in new tabs.
      <div id="template-large-image"><h3 class="large-image-name"></h3><img class="large-image"/></div>
    </div>
    <div id="floats">
    </div>
    <script type="text/javascript">
      (function() {
        runInitializers();
        enableTriggers(get('document'))
      })();
    </script>
  </body>
</html>
